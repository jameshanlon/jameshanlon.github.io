<!DOCTYPE html>
<!-- Make light mode the default for articles since this works better with
    images with a white background and code highlighting. -->
<html lang="en" data-bs-theme=light>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="James W. Hanlon">
  <title>Error-correctingÂ codes</title>
  <link rel="icon" type="image/png" sizes="32x32" href="./theme/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./theme/images/favicon-16x16.png">
  <!-- Default Pygments style -->
  <link rel="stylesheet" type="text/css" href="./theme/css/pygments.css" id="pygments-style"/>
  <link rel="stylesheet" type="text/css" href="./theme/css/main.css"/>
  <link href="https://jameswhanlon.com/reeds/atom.xml"
        type="application/atom+xml" rel="alternate"
        title="James W. Hanlon Atom Feed" />
  <link href="https://jameswhanlon.com/reeds/rss.xml"
        type="application/rss+xml" rel="alternate"
        title="James W. Hanlon RSS Feed" />
  <!-- MathJax -->
  <script>
  MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
              svg: { fontCache: 'global' } };
  </script>
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
  </script>
  <script src="./theme/js/bundle.js"></script>
  <script data-goatcounter="https://jameswhanlon.goatcounter.com/count"
          async src="//gc.zgo.at/count.js"></script>
</head>
<body>
  <header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <div class="container-fluid">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav me-auto mb-2 mb-md-0 text-uppercase">
          <li class="nav-item">
              <a class="nav-link" href="/index.html">notes</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="/projects.html">projects</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="/archive.html">archive</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="/about.html">about</a>
          </li>
          <li class="nav-item">
              <a class="nav-link" href="/links.html">links</a>
          </li>
        </ul>
        <a class="navbar-brand" href="#">James W. Hanlon</a>
        <button class="btn btn-secondary" type="button" onclick="toggleMode(this)">
          <!-- Initial button state -->
            <i class="bi bi-moon-fill"></i>
        </button>
      </div>
    </div>
  </nav>
  </header>

  <main class="flex-shrink-0">
  <div class="container">
  <h1>
    Error-correcting&nbsp;codes
  </h1>
  <div class="lead">
    <time class="published" datetime="2020-05-02T00:00:00+02:00">
      02 May 2020
    </time><br>
      <span class="article-tag small"><a href="/tag/computing.html">computing</a></span>
  </div>
  <div class="article-body">
    <p>Error correcting codes (ECCs) are used in computer and communication systems to
improve resiliency to bit flips caused by permanent hardware faults or
transient conditions, such as neutron particles from cosmic rays, known
generally as <a href="https://en.wikipedia.org/wiki/Soft_error">soft errors</a>. This note
describes the principles of Hamming codes that underpin <span class="caps">ECC</span> schemes, <span class="caps">ECC</span> codes
are constructed, focusing on single-error correction and double error
detection, and how they are&nbsp;implemented.</p>
<p>ECCs work by adding additional redundant bits to be stored or transported with
data. The bits are encoded as a function of the data in such a way that it is
possible to detect erroneous bit flips and to correct them. The ratio of the
number of data bits to the total number of bits encoded is called the <em>code
rate</em>, with a rate of 1 being a an impossible encoding with no&nbsp;overhead.</p>
<h2>Simple&nbsp;ECCs</h2>
<p><strong>Parity coding</strong> adds a single bit that indicates whether the number of set
bits in the data is odd or even. When the data and parity bit is accessed or
received, the parity can be recomputed and compared. This is sufficient to
detect any odd number of bit flips but not to correct them. For applications
where the error rate is low, so that only single bit flips are likely and
double bit flips are rare enough to be ignored, parity error detection is
sufficient and desirable due to it&#8217;s low overhead (just a single bit) and
simple&nbsp;implementation.</p>
<p><strong>Repetition coding</strong> simply repeats each data bit a fixed number of times. When
the encoded data is received, if each of the repeated bits are non identical,
an error has occurred. With a repetition of two, single-bit errors can be
detected but not corrected. With a repetition of three, single bit flips can be
corrected by determining each data bit as the majority value in each triple,
but double bit flips are undetectable and will cause an erroneous correction.
Repetition codes are simple to implement but have a high&nbsp;overhead.</p>
<h2>Hamming&nbsp;codes</h2>
<p>Hamming codes are an efficient family of codes using additional redundant bits to
detect up to two-bit errors and correct single-bit errors (technically, they are
<em><a href="https://en.wikipedia.org/wiki/Linear_code">linear error-correcting codes</a></em>).
In them, <em>check bits</em> are added to data bits to form a <em>codeword</em>, and the
codeword is <em>valid</em> only when the check bits have been generated from the data
bits, according to the Hamming code. The check bits are chosen so that there is
a fixed <em>Hamming distance</em> between any two valid codewords (the number of
positions in which bits&nbsp;differ).</p>
<p>When valid codewords have a Hamming distance of two, any single bit flip will
invalidate the word and allow the error to be detected. For example, the valid&nbsp;codewords <code>00</code> and <code>11</code> are separated for single bit flips by the invalid&nbsp;codewords <code>01</code> and <code>10</code>. If either of the invalid words is obtained an error
has occurred, but neither can be associated with a valid codeword. Two bit
flips are undetectable since they always map to a valid codeword. Note that
parity encoding is an example of a distance-two Hamming&nbsp;code.</p>
<div class="highlight"><pre><span></span><code>00 &lt; Valid codeword
|
10 &lt; Invalid codeword (obtained by exactly 1 bit flip)
|
11 &lt; Valid codeword
</code></pre></div>

<p>With Hamming distance three, any single bit flip in a valid codeword makes an
invalid one, and the invalid codeword is Hamming distance one from exactly one
valid codeword. Using this, the valid codeword can be restored, enabling single
error correction. Any two bit flips map to an invalid codeword, which would
cause correction to the wrong valid&nbsp;codeword.</p>
<div class="highlight"><pre><span></span><code>000 &lt; Valid codeword
 |
001
 |
011
 |
111 &lt; Valid codeword
</code></pre></div>

<p>With Hamming distance four, two bit flips moves any valid codeword Hamming
distance two from exactly two valid codewords, allowing detection of two flips
but not correction. Single bit flips can be corrected as they were for distance
three. Distance-four codes are widely used in computing, where is it often the
case where single errors are frequent, double errors are rare and triple errors
occur so rarely they can be ignored. These codes are referred to as &#8216;<span class="caps">SECDED</span>
<span class="caps">ECC</span>&#8217; (single error correction, double error&nbsp;detection).</p>
<div class="highlight"><pre><span></span><code>0000 &lt; Valid codeword
 |
0001
 |
0011 &lt; Two bit flips from either codeword.
 |
0111
 |
1111 &lt; Valid codeword
</code></pre></div>

<p>Double errors can be corrected with a distance-five code, as well as enabling
the detection of triple errors. In general, if a Hamming code can detect $d$
errors, it must have a minimum distance of $d+1$ so there is no way $d$ errors
can change one valid codeword into another one. If a code can correct $d$
errors, it must have a minimum distance of $2d+1$ so that the originating code
is always the closest one. The following table summarises Hamming&nbsp;codes.</p>
<table class="table table-sm">
<thead>
  <tr>
    <th scope="col">Distance</th>
    <th scope="col">Max bits corrected</th>
    <th scope="col">Max bits detected</th>
    <th scope="col"></th>
  </tr>
</thead>
<tbody>
  <tr>
    <td>2</td>
    <td>0</td>
    <td>1</td>
    <td>Single error detection (eg parity code)</td>
  </tr>
  <tr>
    <td>3</td>
    <td>1</td>
    <td>1</td>
    <td>Single error correction (eg triple repetition code)</td>
  </tr>
  <tr>
    <td>4</td>
    <td>1</td>
    <td>2</td>
    <td>Single error correction, double error detection (a &#8216;<span class="caps">SECDED</span>&#8217; code)</td>
  </tr>
  <tr>
    <td>5</td>
    <td>2</td>
    <td>2</td>
    <td>Double error correction</td>
  </tr>
  <tr>
    <td>6</td>
    <td>2</td>
    <td>3</td>
    <td>Double error correction, triple error detection</td>
  </tr>
</tbody>
</table>

<h2>Creating a Hamming&nbsp;code</h2>
<p>A codeword includes the data bits and checkbits. Each check bit corresponds to
a subset of the data bits and it is set when the parity of those data bits is
odd. To obtain a code with a particular Hamming distance, the number of check
bits and their mapping to data bits must be chosen&nbsp;carefully.</p>
<p>To build a single-error correcting (<span class="caps">SEC</span>) code that requires Hamming distance
three between valid codewords, it is necessary&nbsp;for:</p>
<ul>
<li>The mapping of each data bit to check bits is&nbsp;unique.</li>
<li>Each data bit to map to at least two check&nbsp;bits.</li>
</ul>
<p>To see why this works, consider two distinct codewords that necessarily
must have different data bits. If the data bits differ&nbsp;by:</p>
<ul>
<li>
<p><strong>1 bit</strong>, at least two check bits are flipped, giving a total of three
  different&nbsp;bits.</p>
</li>
<li>
<p><strong>2 bits</strong>, these will cause at least one flip in the check bits since any two
  data bits cannot share the same check-bit mapping (ie by taking the <span class="caps">XOR</span> of
  the two check bit patterns). This also gives a total of three different bits as&nbsp;required.</p>
</li>
<li>
<p><strong>3 bits</strong>, this is already sufficient to give a Hamming distance of&nbsp;three.</p>
</li>
</ul>
<p>To build a <span class="caps">SECDED</span> code that requires Hamming distance of four between valid
codewords, it is necessary&nbsp;for:</p>
<ul>
<li>The mapping of each data bit to check bits is&nbsp;unique.</li>
<li>Each data bit to map to at least three check&nbsp;bits.</li>
<li>Each check bit pattern to have an odd number of bits&nbsp;set.</li>
</ul>
<p>Following a similar argument, consider two distinct codewords, data differing&nbsp;by:</p>
<ul>
<li>
<p><strong>1 bit</strong> flips three check bits, giving a total of four different&nbsp;bits.</p>
</li>
<li>
<p><strong>2 bits</strong> flip check bits in two patterns, and since any two odd-length patterns
  must have at least two non-overlapping bits, the results is at least two
  flipped bits, giving a total of four different bits. For&nbsp;example:</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code>Check bits:  0 1 2 3
data[a]      x x x
data[b]        x x x
-----------  --------
Flips        x     x

Check bits:  0 1 2 3 4
data[a]      x x x
data[b]      x x x x x
----------   ---------
Flips              x x
</code></pre></div>

<ul>
<li><strong>3 bits</strong> flip check bits in three patterns, and this time it is possible to
  overlap odd-length patterns in such a way that a minimum of 1 bit is flipped.
  For&nbsp;example:</li>
</ul>
<div class="highlight"><pre><span></span><code>Check bits:  0 1 2 3 4
data[a]      x x x
data[b]        x x x
data[c]      x     x x
-----------  ---------
Flips                x

Check bits:  0 1 2 3 4
data[a]      x x x x x
data[b]      x x x
data[c]      x     x x
-----------  ---------
Flips        x
</code></pre></div>

<ul>
<li><strong>4 bits</strong> is already sufficient to provide a Hamming distance of&nbsp;four.</li>
</ul>
<p>An example <span class="caps">SEC</span> code for eight data bits with four parity&nbsp;bits:</p>
<div class="highlight"><pre><span></span><code>Check bits:  0 1 2 3
data[0]      x x x
data[1]        x x x
data[2]      x   x x
data[3]      x x   x
data[4]      x x
data[5]        x x
data[6]          x x
data[7]      x     x
</code></pre></div>

<p>An example <span class="caps">SECDED</span> code for eight data bits with five parity&nbsp;bits:</p>
<div class="highlight"><pre><span></span><code>Check bits:  0 1 2 3 4
data[0]      x x x
data[1]      x x   x
data[2]      x   x x
data[3]        x x x
data[4]      x x     x
data[5]      x   x   x
data[6]        x x   x
data[7]      x     x x
</code></pre></div>

<p>Note that mappings of data bits to check bits can be chosen flexibly, providing
they maintain the rules that set the Hamming distance. This flexibility is
useful when implementing <span class="caps">ECC</span> to reduce the cost of calculating the check bits.
In contrast, many descriptions of <span class="caps">ECC</span> that I have found in text books and on
<a href="https://en.wikipedia.org/wiki/Hamming_code">Wikipedia</a> describe a specific
encoding that does not acknowledge this freedom. The encoding they describe
allows the syndrome to be interpreted as the bit index of the single bit error,
by the check bit in position $i$ covering data bits in position $i$.
Additionally, they specify that parity bits are positioned in the codeword at
power-of-two positions, for no apparent&nbsp;benefit.</p>
<h2>Implementing <span class="caps">ECC</span></h2>
<p>Given data bits and check bits, and mapping of data bits to check bits, <span class="caps">ECC</span>
encoding works by calculating the check bits from the data bits, then combining
data bits and check bits to form the codeword. Decoding works by taking the
data bits from a codeword, recalculating the check bits, then calculating the
bitwise <span class="caps">XOR</span> between the original check bits and the recalculated ones. This
value is called the <em>syndrome</em>. By inspecting the number of bits set in the
syndrome, it is possible to determine whether there has been an error,
whether it is correctable, and how to correct&nbsp;it.</p>
<p>Using the <span class="caps">SEC</span> check-bit encoding above, creating a codeword&nbsp;from <code>data[7:0]</code>,
the check bits are calculated as follows (using Verilog&nbsp;syntax):</p>
<div class="highlight"><pre><span></span><code><span class="k">assign</span><span class="w"> </span><span class="n">check_word</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">7</span><span class="p">];</span>
<span class="k">assign</span><span class="w"> </span><span class="n">check_word</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">5</span><span class="p">];</span>
<span class="k">assign</span><span class="w"> </span><span class="n">check_word</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">6</span><span class="p">];</span>
<span class="k">assign</span><span class="w"> </span><span class="n">check_word</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">6</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">7</span><span class="p">];</span>
</code></pre></div>

<p>And the codeword formed by concatenating the check bits and&nbsp;data:</p>
<div class="highlight"><pre><span></span><code><span class="k">assign</span><span class="w"> </span><span class="n">codeword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">check</span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]};</span>
</code></pre></div>

<p>Decoding of a codeword, splits it into the checkword and data bits, recomputes
the check bits and calculates the&nbsp;syndrome:</p>
<div class="highlight"><pre><span></span><code><span class="k">assign</span><span class="w"> </span><span class="p">{</span><span class="n">old_check_word</span><span class="p">,</span><span class="w"> </span><span class="n">old_data</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">codeword</span><span class="p">;</span>
<span class="k">assign</span><span class="w"> </span><span class="n">new_check_word</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
<span class="k">assign</span><span class="w"> </span><span class="n">new_check_word</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
<span class="k">assign</span><span class="w"> </span><span class="n">new_check_word</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
<span class="k">assign</span><span class="w"> </span><span class="n">new_check_word</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
<span class="k">assign</span><span class="w"> </span><span class="n">syndrome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_check_word</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">old_check_word</span><span class="p">;</span>
</code></pre></div>

<p>When single bit errors occur, the syndrome will have the bit pattern
corresponding to a particular data bit, so a correction can be applied by
creating a mask to flip the bit in that&nbsp;position:</p>
<div class="highlight"><pre><span></span><code><span class="n">unique</span><span class="w"> </span><span class="k">case</span><span class="p">(</span><span class="n">syndrome</span><span class="p">)</span>
<span class="w">  </span><span class="mh">4</span><span class="mb">&#39;b1110</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">0</span><span class="p">;</span>
<span class="w">  </span><span class="mh">4</span><span class="mb">&#39;b0111</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">1</span><span class="p">;</span>
<span class="w">  </span><span class="mh">4</span><span class="mb">&#39;b1011</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">2</span><span class="p">;</span>
<span class="w">  </span><span class="mh">4</span><span class="mb">&#39;b1101</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">3</span><span class="p">;</span>
<span class="w">  </span><span class="mh">4</span><span class="mb">&#39;b1100</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">4</span><span class="p">;</span>
<span class="w">  </span><span class="mh">4</span><span class="mb">&#39;b0110</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">5</span><span class="p">;</span>
<span class="w">  </span><span class="mh">4</span><span class="mb">&#39;b0011</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">6</span><span class="p">;</span>
<span class="w">  </span><span class="mh">4</span><span class="mb">&#39;b1001</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">7</span><span class="p">;</span>
<span class="w">  </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="k">endcase</span>
</code></pre></div>

<p>And using it to generate the corrected&nbsp;data:</p>
<div class="highlight"><pre><span></span><code><span class="k">assign</span><span class="w"> </span><span class="n">corrected_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">correction</span><span class="p">;</span>
</code></pre></div>

<p>The value of the syndrome can be further inspected to signal what action has
been taken. If the syndrome&nbsp;is:</p>
<ul>
<li>Equal to zero, no error&nbsp;occurred.</li>
<li>Has one bit set, then this is a flip of a check bit and can be&nbsp;ignored.</li>
<li>Has a value matching a pattern (three bits set or two bits in the adjacent positions), a correctable error&nbsp;occurred.</li>
<li>Has a value not matching a pattern (two bits set in the other non-adjacent&nbsp;positions: <code>4'b1010</code>, <code>4'b0101</code>), or four bits set, a multi-bit uncorrectable error&nbsp;occurred.</li>
</ul>
<p>The above <span class="caps">SECDED</span> check-bit encoding can be implemented in a similar way, but
since it uses only three-bit patterns, mapping syndromes to correction masks
can be done with three-input <span class="caps">AND</span>&nbsp;gates:</p>
<div class="highlight"><pre><span></span><code><span class="n">unique</span><span class="w"> </span><span class="k">case</span><span class="p">(</span><span class="n">syndrome</span><span class="p">)</span>
<span class="w">  </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">1</span><span class="p">;</span>
<span class="w">  </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">2</span><span class="p">;</span>
<span class="w">  </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">3</span><span class="p">;</span>
<span class="w">  </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">4</span><span class="p">;</span>
<span class="w">  </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">5</span><span class="p">;</span>
<span class="w">  </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">6</span><span class="p">;</span>
<span class="w">  </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">syndrome</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="o">&lt;&lt;</span><span class="mh">7</span><span class="p">;</span>
<span class="w">  </span><span class="k">default</span><span class="o">:</span><span class="w">                                   </span><span class="n">correction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="k">endcase</span>
</code></pre></div>

<p>And any syndromes with one or two bits set are correctable, and otherwise&nbsp;uncorrectable.</p>
<h2>References / further&nbsp;reading</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Error_correction_code">Error correction code</a>,&nbsp;Wikipedia.</li>
<li><a href="https://en.wikipedia.org/wiki/Hamming_code">Hamming code</a>,&nbsp;Wikipedia.</li>
<li><a href="https://en.wikipedia.org/wiki/ECC_memory"><span class="caps">ECC</span> memory</a>,&nbsp;Wikipedia.</li>
<li><a href="https://signallake.com/innovation/hamming.pdf">Error detecting and error correcting codes (<span class="caps">PDF</span>)</a>,
  <span class="caps">R. W.</span> Hamming, in The Bell System Technical Journal, vol. 29, no. 2, pp. 147-160, April&nbsp;1950.</li>
<li><a href="http://pages.cs.wisc.edu/~david/courses/cs552/S12/handouts/ecc-phelps.pdf">Constructing an Error Correcting Code (<span class="caps">PDF</span>)</a>,
  Andrew E. Phelps, University of Wisconsin, Madison, November&nbsp;2006.</li>
</ul>
  </div>
  <div class="article-footer">
    <p>Please get in touch (mail @ this domain) with any
    comments, corrections or suggestions.</p>
  </div>
  </div>
  </main>

  <hr>
  <footer class="text-muted">
    <div class="container">
      <div class="small">
        <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
          <img alt="Creative Commons Licence" style="border-width:0"
               src="https://i.creativecommons.org/l/by/4.0/80x15.png" />
        </a>
        <br>
        Unless otherwise noted, all content is freely available under a
        <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
          Creative Commons Attribution 4.0 International License</a>.<br>
        The views expressed on this website are the authorâs personal views and should not be
        attributed to any other person, including that of their employer.<br>
        <br>
        Subscribe: <a href="https://jameswhanlon.com/reeds/atom.xml">Atom</a> /
        <a href="https://jameswhanlon.com/reeds/rss.xml">RSS</a>
      </div>
    </div>
  </footer>
  <script>
    function toggleMode(x) {
      // Toggle the colour mode in Bootstrap.
      if (document.documentElement.getAttribute('data-bs-theme') == 'dark') {
        document.documentElement.setAttribute('data-bs-theme','light')
      }
      else {
        document.documentElement.setAttribute('data-bs-theme','dark')
      }
      // Toggle the light/dark icon.
      x.firstElementChild.classList.toggle('bi-brightness-high-fill');
      x.firstElementChild.classList.toggle('bi-moon-fill');
      // Toggle the Pygments style.
      var elem = document.getElementById('pygments-style');
      if (elem.getAttribute('href') == './theme/css/pygments-dark.css') {
        elem.setAttribute('href', './theme/css/pygments.css');
      } else {
        elem.setAttribute('href', './theme/css/pygments-dark.css');
      }
    }
  </script>
</body>
</html>